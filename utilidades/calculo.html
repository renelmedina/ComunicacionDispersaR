<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">

    <title>Hello, world!</title>
  </head>
  <body>
    <h1>Hello, world!</h1>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
    

    <fieldset>
    <legend>Parametros:</legend>
      Monto Anual UIT: <input type="text" name="txtMontoUITActual" id="txtMontoUITActual" value="4150"><br>
    </fieldset>
    <form action="">
      <table>
        <tr>
          <th>Descripcion</th>
          <th>Monto</th>
          <th>Ayuda</th>
        </tr>
        <tr>
          <td>Renta Bruta obtenida por el ejercicio individual (Profesión, arte, ciencia u oficio)</td>
          <td><input type="number" name="txtRentaBruta" id="txtRentaBruta" onblur="fnDeducciondel20porciento(this.value)"></td>
          <td><small>Suma de todos los recibos por honorarios de todo el año</small></td>
        </tr>
        <tr>
          <td>Deducción (20% del Renta Bruta obtenida - Máximo S/ <span id="spDeduccion20"></span>)</td>
          <td><input type="number" name="txtDeduccion20" id="txtDeduccion20" disabled="disabled"></td>
          <td><small>Gasto que la sunat considera como tu gasto personal(Esto es bueno porque la sunat no te descontara de este monto.)</small></td>
        </tr>
        <tr>
          <td>Renta Neta obtenida por el ejercicio individual (Profesión, arte, ciencia u oficio) </td>
          <td><input type="number" name="txtRentaNeta4taCat" id="txtRentaNeta4taCat" disabled="disabled"></td>
          <td><small>Monto Neto de recibos por 4ta categoria</small></td>
        </tr>
        <tr>
          <td>Otras Rentas de Cuarta Categoría</td>
          <td><input type="number" name="txtOtrasRentaNeta4taCat" id="txtOtrasRentaNeta4taCat"></td>
          <td><small>Por ejemplo cuando eres accionista de una empresa y recibes las utilidades, cuando eres regidor y recibes dietas, etc.</small></td>
        </tr>
        <tr>
          <td><strong>Total Rentas de Cuarta Categoría</strong></td>
          <td><input type="number" name="txtTotalGanancia4ta" id="txtTotalGanancia4ta" disabled="disabled"></td>
          <td><small>Ganancia Total de 4ta Categoria que recibiste en el año</small></td>
        </tr>
        <tr>
          <td><strong>Total de Rentas de Quinta Categoría</strong></td>
          <td><input type="number" name="txtIngresos5taCat" id="txtIngresos5taCat"></td>
          <td><small>La suma del sueldo por planilla de todo el año (normalmente los 14 sueldos + gratificaciones + utilidades,etc)</small></td>
        </tr>
        <tr>
          <td><strong>Total de Rentas de 4ta y 5ta categoría</strong></td>
          <td><input type="number" name="txtIngresos4ta5taCat" id="txtIngresos4ta5taCat" disabled="disabled"></td>
          <td><small>Total de ganancias de 4ta y 5ta categoria</small></td>
        </tr>
        <tr>
          <td>Deducción de 7 UIT (Hasta el límite del total renta de cuarta categoría)</td>
          <td><input type="number" name="txtDeduccion7uit" id="txtDeduccion7uit" disabled="disabled"></td>
          <td><small>De la suma de tus ganancias se le descontara 7 UITs(En beneficio tuyo, mientras mas te deduzcan, menos impuesto te cobrara la sunat)</small></td>
        </tr>
        <tr>
          <td>Deducción de 3 UIT adicionales (Si cumple con los requisitos establecidos por D.L.)</td>
          <td><input type="number" name="txtDeduccion3uit" id="txtDeduccion3uit"></td>
          <td><small>Se te puede deducir hastas 3 UTIs mas, pero debes demostrar con papeles ante la sunat.</small></td>
        </tr>
        <tr>
          <td><strong>Total Renta Neta de Cuarta y Quinta Categoría </strong></td>
          <td><input type="number" name="txtRentaNeta" id="txtRentaNeta" disabled="disabled"></td>
          <td><small>Ganancia Total, restando las deducciones</small></td>
        </tr>
        <tr>
          <td>Deducción por Impuesto a las Transacciones Financieras - ITF</td>
          <td><input type="number" name="txtDeduccionItf" id="txtDeduccionItf"></td>
          <td><small>La suma de todos los montos del ITF(Cuando pagas desde una cuenta corriente)</small></td>
        </tr>
        <tr>
          <td>Deducción por Donaciones</td>
          <td><input type="number" name="txtDeduccionDonaciones" id="txtDeduccionDonaciones"></td>
          <td><small>La suma de todas las donaciones que realizaste(debes demostrar con papeles frente a la Sunat)</small></td>
        </tr>
        <tr>
          <td><h3>Total Renta Imponible de Trabajo</h3></td>
          <td><input type="number" name="txtDeduccionDonaciones" id="txtDeduccionDonaciones" disabled></td>
          <td><small>Esta seria tu ganancia total del año, sobre esto calcularan tu impuesto</small></td>
        </tr>
      </table>
    </form>



  <script>

    function fnDeducciondel20porciento(monto) {
      //=-SI(20%*F3>PARAMETROS!D6*24;PARAMETROS!D6*24;20%*F3)
      // spDeduccion20
      var varUIT= $("#txtMontoUITActual").val();
      var varMontoDeduccionMaximo=varUIT*24;
      //var varIngresoBruto=$("#txtRentaBruta").val()
      var varDeduccion20porciento=monto*20/100
      var MontoDeduccion=0;
      if (varDeduccion20porciento>varMontoDeduccionMaximo) {
        //$("#txtDeduccion20").val(varMontoDeduccionMaximo)
        MontoDeduccion=varMontoDeduccionMaximo;
      }else{
        //$("#txtDeduccion20").val(varDeduccion20porciento)
        MontoDeduccion=varDeduccion20porciento;
      }
      $("#txtDeduccion20").val(MontoDeduccion);
      $("#spDeduccion20").html(varMontoDeduccionMaximo);
      fnRentaNeta4cat(monto,MontoDeduccion);
    }
    function fnRentaNeta4cat(Montobruto,Deduccion20porciento) {
      // body...
      var varRentaNeta4cat=Montobruto-Deduccion20porciento;
      var varOtrosIngresos4ta=$("#txtOtrasRentaNeta4taCat").val()
      $("#txtRentaNeta4taCat").val(varRentaNeta4cat)

      fnTotalRentas4taCat(varRentaNeta4cat,varOtrosIngresos4ta)
    }
    function fnTotalRentas4taCat(MontoNeto,OtrosMontos4ta) {
      // body...
      var varTotalRenta4tacat=parseFloat(MontoNeto)+parseFloat(OtrosMontos4ta);
      $("#txtTotalGanancia4ta").val(varTotalRenta4tacat);

      var varMonto5ta=$("#txtIngresos5taCat").val();
      fnTotalRentas4ta5ta(varTotalRenta4tacat,varMonto5ta)
    }
    function fnTotalRentas4ta5ta(Monto4ta,Monto5ta) {
      // body...
      var varMontoTotal=parseFloat(Monto4ta)+parseFloat(Monto5ta);
      $("#txtIngresos4ta5taCat").val(varMontoTotal)
      fnDeduccionde7Uit($("#txtMontoUITActual").val());
    }
    function fnDeduccionde7Uit(UitActual) {
      // body...
      var varDeduccionde7Uit=UitActual*7;
      $("#txtDeduccion7uit").val(varDeduccionde7Uit);

      var SumadeDeducciones=parseFloat(varDeduccionde7Uit)+parseFloat($("#txtDeduccion3uit").val());
      fnTotalRentaNeta4ta5ta(SumadeDeducciones,$("#txtIngresos4ta5taCat").val());

    }

    function fnTotalRentaNeta4ta5ta(SumaDeUitdeduccion,RentaTotalde4ta5ta) {
      // body...
      var varTotalRentaNeta=parseFloat(RentaTotalde4ta5ta)-parseFloat(SumaDeUitdeduccion);

      if (varTotalRentaNeta<=0) {
        $("#txtRentaNeta").val(0);
      }else{
        $("#txtRentaNeta").val(varTotalRentaNeta);
      }
    }
  </script>
  </body>
</html>